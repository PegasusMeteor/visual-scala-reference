\input{_header.tex}

\matrix (A) [collection] {
  \node (a1) {$a_1$}; &
  \node (a2) {$a_2$}; &
  \helem{between}      &
  \node (ai) {$a_i$}; &
  \node (ai+1) {$a_{i+1}$}; &
  \helem{between}      &
  \node (an) {$a_n$}; \\
};

\matrix (T) [collection, right=\cellwidth of A] {
  \node (t1) {$a_1$}; &
  \node (ti) {$a_i$}; &
  \node (tn) {$a_n$}; &
  \node (tn+1) {$a_{n+1}$}; \\
};

\rightparam{T.east}{\param{that}}

\matrix (B) [collection, below=2\cellheight of A] {
  \node (b1) {$a_1$}; &
  \node (bi) {$a_i$}; &
  \node (bn) {$a_n$}; \\
};

\draw (a1.north) [name path=p1] -- ++(0, .5) -| (t1);
\draw (ai.north) [name path=pi] -- ++(0, 1) -| (ti);
\draw (an.north) [name path=pn] -- ++(0, 1.5) -| (tn);

\path [name intersections={of=p1 and pi, by={a}}] (a) pic {vertical bridge};
\path [name intersections={of=p1 and pn, by={a}}] (a) pic {vertical bridge};
\path [name intersections={of=pi and pn, by={a}}] (a) pic {vertical bridge};

\foreach \i in {1, i, n} {
  \draw (a\i) [smooth arrow] to (b\i);
}

\input{_footer.tex}
