\input{_header.tex}

\matrix (A) [collection] {
    \node (a1) {$a_1$}; &
    \node (a2) {$a_2$}; &
    \ellipsis &
    \node (ai) {$a_i$}; &
    \node (ai+1) {$a_{i+1}$}; &
    \ellipsis &
    \node (an-1) {$a_{n-1}$}; &
    \node (an) {$a_n$}; \\
};

\draw [draw=none] (a2) -- coordinate (ae1) (ai);

\node (z) [left=5mm of A] {\param{z}};

\node (f1) [predicate, below=15mm of a1.west]   {$\param{seqop}(\param{z}, a_1)$};
\node (f2) [predicate, below=25mm of a2.west]   {$\param{seqop}(z_1, a_2)$};
\node (f3) [predicate, below=15mm of ai+1.west] {$\param{seqop}(a_i, a_{i+1})$};
\node (f4) [predicate, below=15mm of an.west]   {$\param{seqop}(a_{n-1}, a_n)$};

\node (f5) [predicate, below=37mm of ae1] {$\param{combop}(z_j, z_k)$};
\node (f6) [predicate, below=50mm of ai+1.west] {$\param{combop}(z_l, z_m)$};

\node (B) [predicate, below=10mm of f6] {$b$};

\begin{scope}
  \tikzstyle{every path}=[arrow]
  \draw [white border, out=270, in=90] (z.south) to (f1.50);
  \draw [white border, out=270, in=90] (a1.south) to (f1.25);

  \draw [white border, out=270, in=90] (ai.south) to (f3.70);
  \draw [white border, out=270, in=90] (ai+1.south) to (f3.25);

  \draw [white border, out=0, in=90] (f1.east) to (f2.60);
  \draw [white border, out=270, in=90] (a2.south) to (f2.25);

  \draw [white border, out=0, in=90, middotted] (f2.east) to (f5.45);
  \draw [white border, out=180, in=90, middotted] (f3.west) to (f5.22);

  \draw [white border, out=270, in=90] (an-1.south) to (f4.70);
  \draw [white border, out=270, in=90] (an.south) to (f4.20);

  \draw [white border, out=180, in=90, middotted] (f4.west) to (f6.20);
  \draw [white border, out=0, in=90, middotted] (f5.east) to (f6.45);

  \draw (f6) -- (B);
\end{scope}

\input{_footer.tex}
