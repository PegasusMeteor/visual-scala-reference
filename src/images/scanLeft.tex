\input{_header.tex}

\matrix (A) [collection, name prefix=a] {
  \node (1) {$a_1$}; &
  \node (2) {$a_2$}; &
  \ellipsis;         &
  \node (i) {$a_i$}; &
  \ellipsis;         &
  \node (n) {$a_n$}; \\
};

\matrix (B) [collection, matrix anchor=bz.east, below of=A, node distance=7cm] at (a1.west) {
  \node (bz) {$\param{z}$}; &
  \node (b1) {$z_1$};        &
  \node (b2) {$z_2$};        &
  \ellipsis;                 &
  \node (bi) {$z_i$};        &
  \ellipsis;                 &
  \node (bn) {$b$};          \\
};

\node (z) [above=61mm of bz] {\param{z}};

\node (f1) [above=4cm of b1] {$\param{op}(\textrm{z}, a_1)$};
\node (f2) [above=3cm of b2] {$\param{op}(z1, a_2)$};
\node (fi) [above=2cm of bi] {$\param{op}(z_{i-1}, a_i)$};
\node (fn) [above=1cm of bn] {$\param{op}(z_{n-1}, a_n)$};

\begin{scope}
  \tikzstyle{every path}=[arrow, smooth]
  \draw (z) edge (bz) edge ([xshift=-0.2em] f1.north);

  \draw (a1) to ([xshift=0.8em] f1.north);
  \draw (f1) edge (b1) edge ([xshift=-0.4em] f2.north);

  \draw (a2) to ([xshift=0.8em] f2.north);
  \draw (f2) edge (b2) edge [middotted] ([xshift=-0.2em] fi.north);

  \draw (ai) to ([xshift=1.4em] fi.north);
  \draw (fi) edge (bi) edge [middotted] ([xshift=-0.2em] fn.north);

  \draw (an) to ([xshift=1.4em] fn.north);
  \draw (fn) edge (bn);
\end{scope}

\input{_footer.tex}
