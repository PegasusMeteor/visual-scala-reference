\input{_header.tex}

\matrix (A) [collection] {
  \node (a1) {$a_1$}; &
  \node (a2) {$a_2$}; &
  \helem{between} &
  \node (ai) {$a_i$}; &
  \helem{between} &
  \node (an) {$a_n$}; \\
};

\foreach \i/\p/\d in {
  1/\false/.25,
  2/\false/1,
  i/\false/.25,
  n/\false/.25}
{
  \node (p\i) [predicate evaluation, above=\d of a\i] {$a_{\i} = \param{elem}? \, \p$};
  \draw (a\i.north) [predicate evaluation edge] -- (p\i);
}

\begin{scope}
  \tikzstyle{every path}=[iteration, bend left=45]
  \draw ($ (p1.north) + (-1, 0) $) to (p1.north);
  \draw (p1.north) [bend left=60] to (p2.north);
  \draw (p2.north) [middle dots] to (pi.north);
  \draw (pi.north) [middle dots] to (pn.north);
\end{scope}

\node (B) [below right=2\cellheight and \cellwidth of A] {\false};
\draw (pn.north) [arrow] .. controls +(2, 1) and +(0, 1) .. (B.north);

\input{_footer.tex}
