---
---

\tikzset{every function node/.style={
    inner xsep=.1\masterunit,
    /function/.cd,
    east port=1,
    north port=1,
    south port=0,
    west port=1,
}}

\matrix (A) [collection, yshift=0.5\masterunit] {
    \node (a1) {$a_1$}; &
    \node (a2) {$a_2$}; &
    \elementsbetween &
    \node (ai) {$a_i$}; &
    \elementsbetween &
    \node (an) {$a_n$}; \\
};

\node (z) [element, left=.5 of A] {\texttt{z}};

\foreach \i in {1,2,i,n}{
    \node (f\i) [subfunction, below=1 of a\i] {\texttt{op}};
    \draw [flow] (a\i) -- (f\i.north);
}

\node (b) [element, right=.5 of fn] {$b$};

\draw [flow] (z) |- (f1.west);
\draw [flow] (f1.east) -- (f2.west);
\draw [solid dashed solid, flow] (f2.east) -- (fi.west);
\draw [solid dashed solid, flow] (fi.east) -- (fn.west);
\draw [flow] (fn.east) -- (b);
