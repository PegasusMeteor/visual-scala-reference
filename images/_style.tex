\newlength{\defaultpenwidth}
\setlength{\defaultpenwidth}{0.04\masterunit}

\definecolor{defaultpencolor}{RGB}{43, 43, 43}

\tikzset{every path/.style={
    draw=defaultpencolor,
    line width=\defaultpenwidth,
}}

\tikzset{every node/.style={
    inner sep=0pt,
    outer sep=0pt,
    node distance=0,
    text=defaultpencolor,
}}

\tikzset{element/.style={
    font=\large,
    inner sep=0.1\masterunit,
}}

\tikzset{subelement/.style={
    font=\small,
    inner sep=0.1\masterunit,
}}

\tikzset{collection element/.style={
    draw,
    element,
    inner sep=0,
    minimum height=\masterunit,
    minimum width=\masterunit,
}}

\tikzset{collection/.style={
    column sep=-\defaultpenwidth,
    nodes={
        collection element,
    },
    outer sep=-0.5\defaultpenwidth,
    row sep=-0.5\defaultpenwidth,
}}

\tikzset{empty collection/.style={
    decorate,
    decoration={
        amplitude=0.025\masterunit,
        angle=45,
        border,
        segment length=0.05\masterunit,
    },
    draw,
    line width=0.01\masterunit,
    minimum height=\masterunit,
    minimum width=0.3\masterunit,
    node contents={}
}}

\tikzset{tuple of collections/.style={
    collection,
    inner sep=.25\masterunit,
    left delimiter=(,
    right delimiter=),
}}

\tikzset{tuple separator/.style={
    draw=none,
    minimum width=0,
    text height=\masterunit,
    font=\Huge,
    node contents={\,,\,\,},
}}

\tikzset{flow width/.style={
    line width=0.75\defaultpenwidth,
}}

\tikzset{flow/.style={
    -{Triangle[fill=defaultpencolor, angle'=30]},
    flow width,
}}

\tikzset{subflow width/.style={
    line width=0.5\defaultpenwidth,
}}

\tikzset{subflow/.style={
    flow,
    subflow width,
}}

\newcommand{\elementsbefore}{
    \node (_eb) [draw=none, minimum width=.75\masterunit] {};
    \coordinate (_eb1) at ($ (_eb.north east) + (-.15, 0) $);
    \coordinate (_eb2) at ($ (_eb.south east) + (-.15, 0) $);
    \draw
        (_eb.north east) -- (_eb1)
        (_eb.south east) -- (_eb2);
    \draw [dashed]
        (_eb1) -- (_eb.north west)
        (_eb2) -- (_eb.south west);
}

\newcommand{\elementsbetween}{%
    \node (_eb) [draw=none, minimum width=1.5\masterunit] {};
    \coordinate (_ea1) at ($ (_eb.north west) + (.15, 0) $);
    \coordinate (_eb1) at ($ (_eb.north east) + (-.15, 0) $);
    \coordinate (_ea2) at ($ (_eb.south west) + (.15, 0) $);
    \coordinate (_eb2) at ($ (_eb.south east) + (-.15, 0) $);
    \draw
        (_eb.north west) -- (_ea1)
        (_eb1) -- (_eb.north east)
        (_eb.south west) -- (_ea2)
        (_eb2) -- (_eb.south east);
    \draw [dashed]
        (_ea1) -- (_eb1)
        (_ea2) -- (_eb2);
}

\newcommand{\elementsafter}{
    \node (_ea) [draw=none, minimum width=.75\masterunit] {};
    \coordinate (_ea1) at ($ (_ea.north west) + (.15, 0) $);
    \coordinate (_ea2) at ($ (_ea.south west) + (.15, 0) $);
    \draw
        (_ea.north west) -- (_ea1)
        (_ea.south west) -- (_ea2);
    \draw [dashed]
        (_ea1) -- (_ea.north east)
        (_ea2) -- (_ea.south east);
}

\tikzset{function/.style={
    shape=function,
    line width=.75\defaultpenwidth,
    minimum width=.75\masterunit,
    minimum height=.75\masterunit,
}}

\tikzset{subfunction/.style={
    shape=function,
    inner xsep=.15\masterunit,
    inner ysep=.2\masterunit,
    line width=.5\defaultpenwidth,
}}

\tikzset{normal brace/.style={
    decorate,
    decoration={
        brace,
        amplitude=.2\masterunit,
        raise=.2\masterunit,
    }
}}

\tikzset{inverse brace/.style={
    normal brace,
    decoration={
        mirror,
    }
}}

\newcommand\normalbrace[2]{
    \draw [normal brace] (#1) -- (#2);
    \coordinate (bracepoint) at ($ (#1)!.5!(#2) + (0, .4) $);
}

\newcommand\inversebrace[2]{
    \draw [line width=\pgflinewidth, inverse brace] (#1) -- (#2);
    \coordinate (bracepoint) at ($ (#1)!.5!(#2) + (0, -.4) $);
}

\tikzset{measure width/.style={
    line width=0.02\masterunit,
}}

\tikzset{measure/.style={
    measure width,
    -{Triangle[angle'=30]},
}}

\newcommand\topmeasure[3]{
    \draw [measure width]
        (#2) -- ++(0, .6)
        (#3) -- ++(0, .6);
    \coordinate (_m1) at ($ (#2) + (0, .5) $);
    \coordinate (_m2) at ($ (#3) + (0, .5) $);
    \node [outer sep=.1\masterunit] (_mn) at ($ (_m1)!.5!(_m2) $) {#1};
    \draw [measure] (_mn) -- (_m1);
    \draw [measure] (_mn) -- (_m2);
}

\tikzset{big arrow/.style={
  draw,
  single arrow,
  single arrow tip angle=60,
  single arrow head extend=.02\masterunit,
  minimum width=.3\masterunit,
  minimum height=.4\masterunit,
  node contents={},
}}

\newcommand{\drawbg}{
     \begin{scope}[on background layer]
         \coordinate (_a) at ($ (current bounding box.south west) + (-.5, -.5) $);
         \coordinate (_b) at ($ (current bounding box.north east) + (.5, .5) $);
         \fill [white] (_a) rectangle (_b);
     \end{scope}
}