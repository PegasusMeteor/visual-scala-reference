---
---

\matrix (A) [collection] {
    \elementsbefore \coordinate (a1) at (lastnode.south west); &
    \node (ai) {$a_i$}; &
    \node (ai+1) {$a_{i + 1}$}; &
    \elementsafter \coordinate (an) at (lastnode.south east); &
\\ };

\matrix (B) [tuple of collections, below=2 of A] {
    \elementsbefore \coordinate (b1) at (lastnode.north west); &
    \node (bi) {$a_i$}; &
    \node [tuple separator]; &
    \node (bi+1) {$a_{i + 1}$}; &
    \elementsafter \coordinate (bn) at (lastnode.north east); &
\\ };

\braceflow[-.2]{(a1.south west)}{($ (ai.south east) + (-.5\defaultpenwidth, 0) $)}
\coordinate (x) at (lastbrace);
\braceflow[.2]{(b1.north west)}{($ (bi.north east) + (-.5\defaultpenwidth, 0) $)}
\draw [flow ->, out=270, in=90] (x) to (lastbrace);

\braceflow[-.2]{(ai+1.south west)}{($ (an.south east) + (-.5\defaultpenwidth, 0) $)}
\coordinate (x) at (lastbrace);
\braceflow[.2]{(bi+1.north west)}{($ (bn.north east) + (-.5\defaultpenwidth, 0) $)}
\draw [flow ->, out=270, in=90] (x) to (lastbrace);
